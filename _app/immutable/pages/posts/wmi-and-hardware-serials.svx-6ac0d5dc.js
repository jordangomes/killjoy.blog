import{S as xo,i as jo,s as Oo,D as il,x as To,y as Ro,z as Ao,A as Fo,B as So,r as qo,p as zo,C as Vo,K as Co,e as a,t as c,k as r,c as l,a as o,h as u,d as s,m as p,L as Le,b as d,g as i,J as t,n as Jo}from"../../chunks/index-6be2d9ac.js";import{P as Ko}from"../../chunks/post-6c236dfd.js";import"../../chunks/header-89bc0213.js";function Qo(V){let h,k,E,M,m,y,$,S,ht,Ne,mt,dt,ms,J,vt,ds,K,wt,vs,ws,ks,Q,kt,_s,Z,_t,ys,X,yt,bs,Y,bt,Is,Es,Ps,ee,It,gs,C,Et,Ue,Pt,gt,Ms,se,B,rl,Ss,te,Mt,Cs,L,St,Ge,Ct,Ws,ae,N,pl,Ds,le,Wt,$s,oe,Dt,Bs,ne,U,cl,Ls,ie,$t,Ns,Us,Gs,re,Bt,Hs,pe,G,ul,xs,ce,Lt,js,ue,Nt,Os,H,He,Ut,Gt,Ts,f,x,xe,Ht,xt,fe,Do='<code class="language-powershell"><span class="token function">Get-CIMClass</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> CimClassName <span class="token punctuation">|</span> <span class="token function">Export-Csv</span> classes<span class="token punctuation">.</span>csv <span class="token operator">-</span>NTI</code>',jt,j,je,Ot,Tt,Oe,Rt,At,P,Te,Ft,qt,Re,zt,Vt,Ae,Jt,Kt,b,Fe,Qt,Zt,he,$o='<code class="language-powershell"><span class="token function">Get-WmiObject</span> <span class="token operator">-</span><span class="token keyword">Class</span> <span class="token string">"Win32_PnPDevice"</span></code>',Xt,me,Yt,O,fl,ea,qe,sa,ta,T,ze,aa,la,Ve,oa,na,R,Je,ia,ra,de,pa,Ke,ca,ua,A,Qe,fa,ha,Ze,ma,da,g,Xe,va,wa,Ye,es,ka,_a,w,ss,ya,ba,ts,Ia,Ea,as,Pa,ga,ls,Ma,Sa,os,Ca,Wa,ns,is,Da,$a,F,rs,Ba,La,ps,Na,Ua,I,ve,Ga,cs,Ha,xa,we,Bo=`<code class="language-powershell"><span class="token function">Get-WmiObject</span> <span class="token operator">-</span><span class="token keyword">Class</span> <span class="token string">"CIM_USBDevice"</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">'PnPDeviceID like "%serial prefix%"'</span></code>`,ja,us,Oa,Ta,ke,Ra,q,hl,Rs,As,Fs,_e,Aa,qs,ye,Fa,zs,be,qa,Vs,z,Lo=`<code class="language-powershell"><span class="token variable">$computers</span> = <span class="token function">Import-Csv</span> input<span class="token punctuation">.</span>csv

<span class="token variable">$results</span> = @<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token variable">$i</span> = 0 
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$computer</span> in <span class="token variable">$computers</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token variable">$i</span><span class="token operator">++</span>
    <span class="token function">Write-Host</span> <span class="token string">"Getting Dock for <span class="token function">$<span class="token punctuation">(</span><span class="token variable">$computer</span><span class="token punctuation">.</span>ComputerName<span class="token punctuation">)</span></span> <span class="token variable">$i</span>/<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$computers</span><span class="token punctuation">.</span>Length<span class="token punctuation">)</span></span>"</span>
    <span class="token variable">$result</span> = <span class="token string">""</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> Computer<span class="token punctuation">,</span> IPAddress<span class="token punctuation">,</span> serial
    <span class="token variable">$result</span><span class="token punctuation">.</span>Computer = <span class="token variable">$computer</span><span class="token punctuation">.</span>ComputerName
    <span class="token variable">$result</span><span class="token punctuation">.</span>IPAddress = <span class="token variable">$computer</span><span class="token punctuation">.</span>IPAddress
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">Test-Connection</span> <span class="token operator">-</span>Quiet <span class="token operator">-</span>ComputerName <span class="token variable">$computer</span><span class="token punctuation">.</span>IPAddress<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$dockDevice</span> = <span class="token function">Get-WmiObject</span> <span class="token operator">-</span><span class="token keyword">Class</span> CIM_USBDevice <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">'PNPDeviceID like "%serial prefix%"'</span> <span class="token operator">-</span>ComputerName <span class="token variable">$computer</span><span class="token punctuation">.</span>IPAddress
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dockDevice</span><span class="token punctuation">.</span>Name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$dockSerial</span> = $<span class="token punctuation">(</span><span class="token variable">$dockDevice</span><span class="token punctuation">.</span>PNPDeviceID <span class="token punctuation">|</span> <span class="token function">Split-Path</span> <span class="token operator">-</span>Leaf<span class="token punctuation">)</span><span class="token punctuation">.</span>substring<span class="token punctuation">(</span>6<span class="token punctuation">)</span> 
            <span class="token function">Write-Host</span> <span class="token string">"Dock Found <span class="token variable">$dockSerial</span>"</span>
            <span class="token variable">$result</span><span class="token punctuation">.</span>serial = <span class="token variable">$dockSerial</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token function">Write-Host</span> <span class="token string">"No Dock Found"</span>
        <span class="token punctuation">&#125;</span>
        <span class="token variable">$results</span> <span class="token operator">+=</span> <span class="token variable">$result</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">Write-Host</span> <span class="token string">"Device Offline"</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$results</span> <span class="token punctuation">|</span> <span class="token function">export-csv</span> <span class="token operator">-</span>NoTypeInformation <span class="token string">"results.csv"</span></code>`,Js,Ie,za,Ks,Ee,Va,Qs,Pe,Ja,Zs,ge,Ka,Xs,Me,fs,Qa,Ys,Se,hs,Za,et,st,tt,Ce,Xa,at,We,Ya,lt,De,el;return{c(){h=a("p"),k=a("em"),E=c("Note - this method will not work for every device"),M=r(),m=a("h2"),y=c("why?"),$=r(),S=a("p"),ht=c("I recently had a little problem at work. During the \xA0 "),Ne=a("em"),mt=c("p a n d e m i c"),dt=c(" \xA0 we sent our staff home with brand new laptops and docks."),ms=r(),J=a("p"),vt=c("The problem is that due to the rush we only recorded laptop serials and missed the docks. Our team could have done the normal thing and sent emails out to everyone and got them to send us the serial numbers but staff aren\u2019t always the smartest and that would also be lame."),ds=r(),K=a("p"),wt=c("I searched far and wide for a solution to get the USB-C dock serials remotely but alas after venturing to the second page of Google I gave up (\u256F\u2035\u25A1\u2032)\u256F\uFE35\u253B\u2501\u253B"),vs=r(),ws=a("br"),ks=r(),Q=a("h2"),kt=c("what now"),_s=r(),Z=a("p"),_t=c(`Many days went by and this problem kept taunting me; there had to be a way.
Finally I cracked and decided to investigate this myself.`),ys=r(),X=a("p"),yt=c("(\u30D8\uFF65_\uFF65)\u30D8\u2533\u2501\u2533"),bs=r(),Y=a("p"),bt=c("My first point of call\u2026 Device Manager"),Is=r(),Es=a("br"),Ps=r(),ee=a("h2"),It=c("adventures in device manager"),gs=r(),C=a("p"),Et=c("Stuff is a bit redacted here for  "),Ue=a("em"),Pt=c("~opsec~"),gt=c(" so you may need to use your imagination a bit"),Ms=r(),se=a("p"),B=a("img"),Ss=r(),te=a("p"),Mt=c("Great\u2026 where the hell is my dock."),Cs=r(),L=a("p"),St=c("Fortunately there is a nicer way to look for things. Just click "),Ge=a("code"),Ct=c("View > Devices by container"),Ws=r(),ae=a("p"),N=a("img"),Ds=r(),le=a("p"),Wt=c("Much better. Now we are here I can see my dock much easier. It\u2019s showing up as USB-I2C bridge here but in previous driver versions it was actually showing up as the model of the dock."),$s=r(),oe=a("p"),Dt=c("Anyway after digging through the devices and their properties I discovered that the serial number of the dock was visible in the \u201CLast known parent\u201D field on the USB controllers and the billboard device."),Bs=r(),ne=a("p"),U=a("img"),Ls=r(),ie=a("p"),$t=c("Cool so we know that the serial is accessible by the system somehow. I just need to work out how to do it programmatically."),Ns=r(),Us=a("br"),Gs=r(),re=a("h2"),Bt=c("doing it programmatically"),Hs=r(),pe=a("p"),G=a("img"),xs=r(),ce=a("p"),Lt=c("Okay Google time\u2026 \u201CPowerShell device manager\u201D. Someone mentions WMI on Microsoft technet."),js=r(),ue=a("p"),Nt=c("I know a thing or two about WMI so I think I can do this."),Os=r(),H=a("h2"),He=a("strong"),Ut=c("Here are 10 WMI secrets that Microsoft don\u2019t want you to know"),Gt=c(" or something, idk I don\u2019t work at buzzfeed."),Ts=r(),f=a("ol"),x=a("li"),xe=a("p"),Ht=c("WMI has classes. What are the classes?"),xt=r(),fe=a("pre"),jt=r(),j=a("li"),je=a("p"),Ot=c("What does that do?"),Tt=r(),Oe=a("p"),Rt=c("it saves a csv file with all the class names"),At=r(),P=a("li"),Te=a("p"),Ft=c("Cool but which heckin class do I need?"),qt=r(),Re=a("p"),zt=c(`this is a bit of vibes based trial and error\u2026 just search the file for what you think it will be.
In this case I searched for \u201Cdevice\u201D which returned 50 classes \u{1F62E}`),Vt=r(),Ae=a("p"),Jt=c(`in those 50 classes a lot of them started with Win32_PnPDevice (I think PnP means plug and play)
so lets query that class and see what is has`),Kt=r(),b=a("li"),Fe=a("p"),Qt=c("How do I query the class"),Zt=r(),he=a("pre"),Xt=r(),me=a("p"),Yt=c(`cool now wtf is this
`),O=a("img"),ea=r(),qe=a("p"),sa=c("again\u2026 I have no idea."),ta=r(),T=a("li"),ze=a("p"),aa=c("So if that doesn\u2019t work where next?"),la=r(),Ve=a("p"),oa=c("\u2026it\u2019s WMI so the answer is always classes"),na=r(),R=a("li"),Je=a("p"),ia=c("Which class?"),ra=r(),de=a("p"),pa=c("again\u2026 "),Ke=a("em"),ca=c("~vibes~"),ua=r(),A=a("li"),Qe=a("p"),fa=c("What did your vibes tell you?"),ha=r(),Ze=a("p"),ma=c("idk are there any USB classes?"),da=r(),g=a("li"),Xe=a("p"),va=c("Are there USB classes?"),wa=r(),Ye=a("p"),es=a("strong"),ka=c("yep"),_a=r(),w=a("ul"),ss=a("li"),ya=c("CIM_USBController - might be it\u2026"),ba=r(),ts=a("li"),Ia=c("Win32_USBController - might be it again\u2026"),Ea=r(),as=a("li"),Pa=c("CIM_USBDevice - that could be it, I mean it is a device \u{1F914}"),ga=r(),ls=a("li"),Ma=c("CIM_USBHub - I guess it is a hub"),Sa=r(),os=a("li"),Ca=c("Win32_USBHub - what is the difference between CIM and Win32\u2026 idk?"),Wa=r(),ns=a("li"),is=a("em"),Da=c("and also a bunch of other junk classes"),$a=r(),F=a("li"),rs=a("p"),Ba=c("So spit it out, we only have 2 more points. Where is the serial man?"),La=r(),ps=a("p"),Na=c("its CIM_USBDevice \u{1F973}"),Ua=r(),I=a("li"),ve=a("p"),Ga=c("Sweet, so how do we get it "),cs=a("em"),Ha=c("~ programmatically ~"),xa=r(),we=a("pre"),ja=r(),us=a("p"),Oa=c("This searches for the serial prefix in all the USB device ID\u2019s. Obviously you will need to swap it out for your own serials prefix if you are following along at home."),Ta=r(),ke=a("p"),Ra=c(`wow\u2026 look at that. I have 3 serials more than I need
`),q=a("img"),Rs=r(),As=a("br"),Fs=r(),_e=a("h2"),Aa=c("cool so now that I am a powershell/WMI god how do I use this?"),qs=r(),ye=a("p"),Fa=c("This is where you can get creative and do things your way. I\u2019ll walk you through mine"),zs=r(),be=a("p"),qa=c("So my solution for getting this info remotely was this"),Vs=r(),z=a("pre"),Js=r(),Ie=a("p"),za=c("the way this works is I have a script that if I feed it a list of host names it returns the IP address and whether its online."),Ks=r(),Ee=a("p"),Va=c("the input.csv file comes from the output of the ping script and has 3 columns ComputerName, IPAddress, Ping"),Qs=r(),Pe=a("p"),Ja=c("I remove all the non VPN IP addresses from the input before running the script because I only want to get the dock serials people working from home."),Zs=r(),ge=a("p"),Ka=c("Finally when I run this the script will return a csv file with the Computer names, IP addresses and the dock serial numbers"),Xs=r(),Me=a("p"),fs=a("strong"),Qa=c("Note - the reason I ping the computers again while the script is runs is because the computers may have gone offline since I initially got the list of computers to check and Get-WmiObject takes a long time to timeout"),Ys=r(),Se=a("p"),hs=a("strong"),Za=c("Note - if you are stealing this script you will definitely need to edit the serial prefix on line 13 and also the serial clean up on line 15"),et=r(),st=a("br"),tt=r(),Ce=a("h2"),Xa=c("Success!!!"),at=r(),We=a("p"),Ya=c("So finally I had my list of people with docks and everyone lived happily ever after."),lt=r(),De=a("p"),el=c("Hopefully if you are reading this it is of some use to you or at least you learnt something. If not good luck Googling soldier"),this.h()},l(e){h=l(e,"P",{});var n=o(h);k=l(n,"EM",{});var ml=o(k);E=u(ml,"Note - this method will not work for every device"),ml.forEach(s),n.forEach(s),M=p(e),m=l(e,"H2",{});var dl=o(m);y=u(dl,"why?"),dl.forEach(s),$=p(e),S=l(e,"P",{});var ot=o(S);ht=u(ot,"I recently had a little problem at work. During the \xA0 "),Ne=l(ot,"EM",{});var vl=o(Ne);mt=u(vl,"p a n d e m i c"),vl.forEach(s),dt=u(ot," \xA0 we sent our staff home with brand new laptops and docks."),ot.forEach(s),ms=p(e),J=l(e,"P",{});var wl=o(J);vt=u(wl,"The problem is that due to the rush we only recorded laptop serials and missed the docks. Our team could have done the normal thing and sent emails out to everyone and got them to send us the serial numbers but staff aren\u2019t always the smartest and that would also be lame."),wl.forEach(s),ds=p(e),K=l(e,"P",{});var kl=o(K);wt=u(kl,"I searched far and wide for a solution to get the USB-C dock serials remotely but alas after venturing to the second page of Google I gave up (\u256F\u2035\u25A1\u2032)\u256F\uFE35\u253B\u2501\u253B"),kl.forEach(s),vs=p(e),ws=l(e,"BR",{}),ks=p(e),Q=l(e,"H2",{});var _l=o(Q);kt=u(_l,"what now"),_l.forEach(s),_s=p(e),Z=l(e,"P",{});var yl=o(Z);_t=u(yl,`Many days went by and this problem kept taunting me; there had to be a way.
Finally I cracked and decided to investigate this myself.`),yl.forEach(s),ys=p(e),X=l(e,"P",{});var bl=o(X);yt=u(bl,"(\u30D8\uFF65_\uFF65)\u30D8\u2533\u2501\u2533"),bl.forEach(s),bs=p(e),Y=l(e,"P",{});var Il=o(Y);bt=u(Il,"My first point of call\u2026 Device Manager"),Il.forEach(s),Is=p(e),Es=l(e,"BR",{}),Ps=p(e),ee=l(e,"H2",{});var El=o(ee);It=u(El,"adventures in device manager"),El.forEach(s),gs=p(e),C=l(e,"P",{});var nt=o(C);Et=u(nt,"Stuff is a bit redacted here for  "),Ue=l(nt,"EM",{});var Pl=o(Ue);Pt=u(Pl,"~opsec~"),Pl.forEach(s),gt=u(nt," so you may need to use your imagination a bit"),nt.forEach(s),Ms=p(e),se=l(e,"P",{});var gl=o(se);B=l(gl,"IMG",{src:!0,alt:!0,title:!0}),gl.forEach(s),Ss=p(e),te=l(e,"P",{});var Ml=o(te);Mt=u(Ml,"Great\u2026 where the hell is my dock."),Ml.forEach(s),Cs=p(e),L=l(e,"P",{});var sl=o(L);St=u(sl,"Fortunately there is a nicer way to look for things. Just click "),Ge=l(sl,"CODE",{});var Sl=o(Ge);Ct=u(Sl,"View > Devices by container"),Sl.forEach(s),sl.forEach(s),Ws=p(e),ae=l(e,"P",{});var Cl=o(ae);N=l(Cl,"IMG",{src:!0,alt:!0,title:!0}),Cl.forEach(s),Ds=p(e),le=l(e,"P",{});var Wl=o(le);Wt=u(Wl,"Much better. Now we are here I can see my dock much easier. It\u2019s showing up as USB-I2C bridge here but in previous driver versions it was actually showing up as the model of the dock."),Wl.forEach(s),$s=p(e),oe=l(e,"P",{});var Dl=o(oe);Dt=u(Dl,"Anyway after digging through the devices and their properties I discovered that the serial number of the dock was visible in the \u201CLast known parent\u201D field on the USB controllers and the billboard device."),Dl.forEach(s),Bs=p(e),ne=l(e,"P",{});var $l=o(ne);U=l($l,"IMG",{src:!0,alt:!0,title:!0}),$l.forEach(s),Ls=p(e),ie=l(e,"P",{});var Bl=o(ie);$t=u(Bl,"Cool so we know that the serial is accessible by the system somehow. I just need to work out how to do it programmatically."),Bl.forEach(s),Ns=p(e),Us=l(e,"BR",{}),Gs=p(e),re=l(e,"H2",{});var Ll=o(re);Bt=u(Ll,"doing it programmatically"),Ll.forEach(s),Hs=p(e),pe=l(e,"P",{});var Nl=o(pe);G=l(Nl,"IMG",{src:!0,alt:!0,title:!0}),Nl.forEach(s),xs=p(e),ce=l(e,"P",{});var Ul=o(ce);Lt=u(Ul,"Okay Google time\u2026 \u201CPowerShell device manager\u201D. Someone mentions WMI on Microsoft technet."),Ul.forEach(s),js=p(e),ue=l(e,"P",{});var Gl=o(ue);Nt=u(Gl,"I know a thing or two about WMI so I think I can do this."),Gl.forEach(s),Os=p(e),H=l(e,"H2",{});var tl=o(H);He=l(tl,"STRONG",{});var Hl=o(He);Ut=u(Hl,"Here are 10 WMI secrets that Microsoft don\u2019t want you to know"),Hl.forEach(s),Gt=u(tl," or something, idk I don\u2019t work at buzzfeed."),tl.forEach(s),Ts=p(e),f=l(e,"OL",{});var v=o(f);x=l(v,"LI",{});var it=o(x);xe=l(it,"P",{});var xl=o(xe);Ht=u(xl,"WMI has classes. What are the classes?"),xl.forEach(s),xt=p(it),fe=l(it,"PRE",{class:!0});var No=o(fe);No.forEach(s),it.forEach(s),jt=p(v),j=l(v,"LI",{});var rt=o(j);je=l(rt,"P",{});var jl=o(je);Ot=u(jl,"What does that do?"),jl.forEach(s),Tt=p(rt),Oe=l(rt,"P",{});var Ol=o(Oe);Rt=u(Ol,"it saves a csv file with all the class names"),Ol.forEach(s),rt.forEach(s),At=p(v),P=l(v,"LI",{});var $e=o(P);Te=l($e,"P",{});var Tl=o(Te);Ft=u(Tl,"Cool but which heckin class do I need?"),Tl.forEach(s),qt=p($e),Re=l($e,"P",{});var Rl=o(Re);zt=u(Rl,`this is a bit of vibes based trial and error\u2026 just search the file for what you think it will be.
In this case I searched for \u201Cdevice\u201D which returned 50 classes \u{1F62E}`),Rl.forEach(s),Vt=p($e),Ae=l($e,"P",{});var Al=o(Ae);Jt=u(Al,`in those 50 classes a lot of them started with Win32_PnPDevice (I think PnP means plug and play)
so lets query that class and see what is has`),Al.forEach(s),$e.forEach(s),Kt=p(v),b=l(v,"LI",{});var W=o(b);Fe=l(W,"P",{});var Fl=o(Fe);Qt=u(Fl,"How do I query the class"),Fl.forEach(s),Zt=p(W),he=l(W,"PRE",{class:!0});var Uo=o(he);Uo.forEach(s),Xt=p(W),me=l(W,"P",{});var al=o(me);Yt=u(al,`cool now wtf is this
`),O=l(al,"IMG",{src:!0,alt:!0,title:!0}),al.forEach(s),ea=p(W),qe=l(W,"P",{});var ql=o(qe);sa=u(ql,"again\u2026 I have no idea."),ql.forEach(s),W.forEach(s),ta=p(v),T=l(v,"LI",{});var pt=o(T);ze=l(pt,"P",{});var zl=o(ze);aa=u(zl,"So if that doesn\u2019t work where next?"),zl.forEach(s),la=p(pt),Ve=l(pt,"P",{});var Vl=o(Ve);oa=u(Vl,"\u2026it\u2019s WMI so the answer is always classes"),Vl.forEach(s),pt.forEach(s),na=p(v),R=l(v,"LI",{});var ct=o(R);Je=l(ct,"P",{});var Jl=o(Je);ia=u(Jl,"Which class?"),Jl.forEach(s),ra=p(ct),de=l(ct,"P",{});var ll=o(de);pa=u(ll,"again\u2026 "),Ke=l(ll,"EM",{});var Kl=o(Ke);ca=u(Kl,"~vibes~"),Kl.forEach(s),ll.forEach(s),ct.forEach(s),ua=p(v),A=l(v,"LI",{});var ut=o(A);Qe=l(ut,"P",{});var Ql=o(Qe);fa=u(Ql,"What did your vibes tell you?"),Ql.forEach(s),ha=p(ut),Ze=l(ut,"P",{});var Zl=o(Ze);ma=u(Zl,"idk are there any USB classes?"),Zl.forEach(s),ut.forEach(s),da=p(v),g=l(v,"LI",{});var Be=o(g);Xe=l(Be,"P",{});var Xl=o(Xe);va=u(Xl,"Are there USB classes?"),Xl.forEach(s),wa=p(Be),Ye=l(Be,"P",{});var Yl=o(Ye);es=l(Yl,"STRONG",{});var eo=o(es);ka=u(eo,"yep"),eo.forEach(s),Yl.forEach(s),_a=p(Be),w=l(Be,"UL",{});var _=o(w);ss=l(_,"LI",{});var so=o(ss);ya=u(so,"CIM_USBController - might be it\u2026"),so.forEach(s),ba=p(_),ts=l(_,"LI",{});var to=o(ts);Ia=u(to,"Win32_USBController - might be it again\u2026"),to.forEach(s),Ea=p(_),as=l(_,"LI",{});var ao=o(as);Pa=u(ao,"CIM_USBDevice - that could be it, I mean it is a device \u{1F914}"),ao.forEach(s),ga=p(_),ls=l(_,"LI",{});var lo=o(ls);Ma=u(lo,"CIM_USBHub - I guess it is a hub"),lo.forEach(s),Sa=p(_),os=l(_,"LI",{});var oo=o(os);Ca=u(oo,"Win32_USBHub - what is the difference between CIM and Win32\u2026 idk?"),oo.forEach(s),Wa=p(_),ns=l(_,"LI",{});var no=o(ns);is=l(no,"EM",{});var io=o(is);Da=u(io,"and also a bunch of other junk classes"),io.forEach(s),no.forEach(s),_.forEach(s),Be.forEach(s),$a=p(v),F=l(v,"LI",{});var ft=o(F);rs=l(ft,"P",{});var ro=o(rs);Ba=u(ro,"So spit it out, we only have 2 more points. Where is the serial man?"),ro.forEach(s),La=p(ft),ps=l(ft,"P",{});var po=o(ps);Na=u(po,"its CIM_USBDevice \u{1F973}"),po.forEach(s),ft.forEach(s),Ua=p(v),I=l(v,"LI",{});var D=o(I);ve=l(D,"P",{});var ol=o(ve);Ga=u(ol,"Sweet, so how do we get it "),cs=l(ol,"EM",{});var co=o(cs);Ha=u(co,"~ programmatically ~"),co.forEach(s),ol.forEach(s),xa=p(D),we=l(D,"PRE",{class:!0});var Go=o(we);Go.forEach(s),ja=p(D),us=l(D,"P",{});var uo=o(us);Oa=u(uo,"This searches for the serial prefix in all the USB device ID\u2019s. Obviously you will need to swap it out for your own serials prefix if you are following along at home."),uo.forEach(s),Ta=p(D),ke=l(D,"P",{});var nl=o(ke);Ra=u(nl,`wow\u2026 look at that. I have 3 serials more than I need
`),q=l(nl,"IMG",{src:!0,alt:!0,title:!0}),nl.forEach(s),D.forEach(s),v.forEach(s),Rs=p(e),As=l(e,"BR",{}),Fs=p(e),_e=l(e,"H2",{});var fo=o(_e);Aa=u(fo,"cool so now that I am a powershell/WMI god how do I use this?"),fo.forEach(s),qs=p(e),ye=l(e,"P",{});var ho=o(ye);Fa=u(ho,"This is where you can get creative and do things your way. I\u2019ll walk you through mine"),ho.forEach(s),zs=p(e),be=l(e,"P",{});var mo=o(be);qa=u(mo,"So my solution for getting this info remotely was this"),mo.forEach(s),Vs=p(e),z=l(e,"PRE",{class:!0});var Ho=o(z);Ho.forEach(s),Js=p(e),Ie=l(e,"P",{});var vo=o(Ie);za=u(vo,"the way this works is I have a script that if I feed it a list of host names it returns the IP address and whether its online."),vo.forEach(s),Ks=p(e),Ee=l(e,"P",{});var wo=o(Ee);Va=u(wo,"the input.csv file comes from the output of the ping script and has 3 columns ComputerName, IPAddress, Ping"),wo.forEach(s),Qs=p(e),Pe=l(e,"P",{});var ko=o(Pe);Ja=u(ko,"I remove all the non VPN IP addresses from the input before running the script because I only want to get the dock serials people working from home."),ko.forEach(s),Zs=p(e),ge=l(e,"P",{});var _o=o(ge);Ka=u(_o,"Finally when I run this the script will return a csv file with the Computer names, IP addresses and the dock serial numbers"),_o.forEach(s),Xs=p(e),Me=l(e,"P",{});var yo=o(Me);fs=l(yo,"STRONG",{});var bo=o(fs);Qa=u(bo,"Note - the reason I ping the computers again while the script is runs is because the computers may have gone offline since I initially got the list of computers to check and Get-WmiObject takes a long time to timeout"),bo.forEach(s),yo.forEach(s),Ys=p(e),Se=l(e,"P",{});var Io=o(Se);hs=l(Io,"STRONG",{});var Eo=o(hs);Za=u(Eo,"Note - if you are stealing this script you will definitely need to edit the serial prefix on line 13 and also the serial clean up on line 15"),Eo.forEach(s),Io.forEach(s),et=p(e),st=l(e,"BR",{}),tt=p(e),Ce=l(e,"H2",{});var Po=o(Ce);Xa=u(Po,"Success!!!"),Po.forEach(s),at=p(e),We=l(e,"P",{});var go=o(We);Ya=u(go,"So finally I had my list of people with docks and everyone lived happily ever after."),go.forEach(s),lt=p(e),De=l(e,"P",{});var Mo=o(De);el=u(Mo,"Hopefully if you are reading this it is of some use to you or at least you learnt something. If not good luck Googling soldier"),Mo.forEach(s),this.h()},h(){Le(B.src,rl="/img/wmi-and-hardware-serials/devmgmt.png")||d(B,"src",rl),d(B,"alt","Screenshot of Windows Device Manager"),d(B,"title","Device Manager"),Le(N.src,pl="/img/wmi-and-hardware-serials/devmgmt-container-view.png")||d(N,"src",pl),d(N,"alt","Screenshot of Windows Device Manager in Devices by container view"),d(N,"title","Device Manager > view > devices by container"),Le(U.src,cl="/img/wmi-and-hardware-serials/devmgmt-success.png")||d(U,"src",cl),d(U,"alt","Screenshot of Windows Device Manager Details tab showing my dock serial number"),d(U,"title","Device Manager"),Le(G.src,ul="/img/shared-memes/noidea.jpg")||d(G,"src",ul),d(G,"alt","dog on a computer captioned I have no idea what I'm doing"),d(G,"title","noidea.jpg"),d(fe,"class","language-powershell"),d(he,"class","language-powershell"),Le(O.src,fl="/img/wmi-and-hardware-serials/wtf.jpg")||d(O,"src",fl),d(O,"alt","Screenshot of garbage powershell WMI results"),d(O,"title","wtf.jpg"),d(we,"class","language-powershell"),Le(q.src,hl="/img/wmi-and-hardware-serials/wmi-query.png")||d(q,"src",hl),d(q,"alt","Screenshot of powershell WMI results with lots of serial numbers"),d(q,"title","success.jpg"),d(z,"class","language-powershell")},m(e,n){i(e,h,n),t(h,k),t(k,E),i(e,M,n),i(e,m,n),t(m,y),i(e,$,n),i(e,S,n),t(S,ht),t(S,Ne),t(Ne,mt),t(S,dt),i(e,ms,n),i(e,J,n),t(J,vt),i(e,ds,n),i(e,K,n),t(K,wt),i(e,vs,n),i(e,ws,n),i(e,ks,n),i(e,Q,n),t(Q,kt),i(e,_s,n),i(e,Z,n),t(Z,_t),i(e,ys,n),i(e,X,n),t(X,yt),i(e,bs,n),i(e,Y,n),t(Y,bt),i(e,Is,n),i(e,Es,n),i(e,Ps,n),i(e,ee,n),t(ee,It),i(e,gs,n),i(e,C,n),t(C,Et),t(C,Ue),t(Ue,Pt),t(C,gt),i(e,Ms,n),i(e,se,n),t(se,B),i(e,Ss,n),i(e,te,n),t(te,Mt),i(e,Cs,n),i(e,L,n),t(L,St),t(L,Ge),t(Ge,Ct),i(e,Ws,n),i(e,ae,n),t(ae,N),i(e,Ds,n),i(e,le,n),t(le,Wt),i(e,$s,n),i(e,oe,n),t(oe,Dt),i(e,Bs,n),i(e,ne,n),t(ne,U),i(e,Ls,n),i(e,ie,n),t(ie,$t),i(e,Ns,n),i(e,Us,n),i(e,Gs,n),i(e,re,n),t(re,Bt),i(e,Hs,n),i(e,pe,n),t(pe,G),i(e,xs,n),i(e,ce,n),t(ce,Lt),i(e,js,n),i(e,ue,n),t(ue,Nt),i(e,Os,n),i(e,H,n),t(H,He),t(He,Ut),t(H,Gt),i(e,Ts,n),i(e,f,n),t(f,x),t(x,xe),t(xe,Ht),t(x,xt),t(x,fe),fe.innerHTML=Do,t(f,jt),t(f,j),t(j,je),t(je,Ot),t(j,Tt),t(j,Oe),t(Oe,Rt),t(f,At),t(f,P),t(P,Te),t(Te,Ft),t(P,qt),t(P,Re),t(Re,zt),t(P,Vt),t(P,Ae),t(Ae,Jt),t(f,Kt),t(f,b),t(b,Fe),t(Fe,Qt),t(b,Zt),t(b,he),he.innerHTML=$o,t(b,Xt),t(b,me),t(me,Yt),t(me,O),t(b,ea),t(b,qe),t(qe,sa),t(f,ta),t(f,T),t(T,ze),t(ze,aa),t(T,la),t(T,Ve),t(Ve,oa),t(f,na),t(f,R),t(R,Je),t(Je,ia),t(R,ra),t(R,de),t(de,pa),t(de,Ke),t(Ke,ca),t(f,ua),t(f,A),t(A,Qe),t(Qe,fa),t(A,ha),t(A,Ze),t(Ze,ma),t(f,da),t(f,g),t(g,Xe),t(Xe,va),t(g,wa),t(g,Ye),t(Ye,es),t(es,ka),t(g,_a),t(g,w),t(w,ss),t(ss,ya),t(w,ba),t(w,ts),t(ts,Ia),t(w,Ea),t(w,as),t(as,Pa),t(w,ga),t(w,ls),t(ls,Ma),t(w,Sa),t(w,os),t(os,Ca),t(w,Wa),t(w,ns),t(ns,is),t(is,Da),t(f,$a),t(f,F),t(F,rs),t(rs,Ba),t(F,La),t(F,ps),t(ps,Na),t(f,Ua),t(f,I),t(I,ve),t(ve,Ga),t(ve,cs),t(cs,Ha),t(I,xa),t(I,we),we.innerHTML=Bo,t(I,ja),t(I,us),t(us,Oa),t(I,Ta),t(I,ke),t(ke,Ra),t(ke,q),i(e,Rs,n),i(e,As,n),i(e,Fs,n),i(e,_e,n),t(_e,Aa),i(e,qs,n),i(e,ye,n),t(ye,Fa),i(e,zs,n),i(e,be,n),t(be,qa),i(e,Vs,n),i(e,z,n),z.innerHTML=Lo,i(e,Js,n),i(e,Ie,n),t(Ie,za),i(e,Ks,n),i(e,Ee,n),t(Ee,Va),i(e,Qs,n),i(e,Pe,n),t(Pe,Ja),i(e,Zs,n),i(e,ge,n),t(ge,Ka),i(e,Xs,n),i(e,Me,n),t(Me,fs),t(fs,Qa),i(e,Ys,n),i(e,Se,n),t(Se,hs),t(hs,Za),i(e,et,n),i(e,st,n),i(e,tt,n),i(e,Ce,n),t(Ce,Xa),i(e,at,n),i(e,We,n),t(We,Ya),i(e,lt,n),i(e,De,n),t(De,el)},p:Jo,d(e){e&&s(h),e&&s(M),e&&s(m),e&&s($),e&&s(S),e&&s(ms),e&&s(J),e&&s(ds),e&&s(K),e&&s(vs),e&&s(ws),e&&s(ks),e&&s(Q),e&&s(_s),e&&s(Z),e&&s(ys),e&&s(X),e&&s(bs),e&&s(Y),e&&s(Is),e&&s(Es),e&&s(Ps),e&&s(ee),e&&s(gs),e&&s(C),e&&s(Ms),e&&s(se),e&&s(Ss),e&&s(te),e&&s(Cs),e&&s(L),e&&s(Ws),e&&s(ae),e&&s(Ds),e&&s(le),e&&s($s),e&&s(oe),e&&s(Bs),e&&s(ne),e&&s(Ls),e&&s(ie),e&&s(Ns),e&&s(Us),e&&s(Gs),e&&s(re),e&&s(Hs),e&&s(pe),e&&s(xs),e&&s(ce),e&&s(js),e&&s(ue),e&&s(Os),e&&s(H),e&&s(Ts),e&&s(f),e&&s(Rs),e&&s(As),e&&s(Fs),e&&s(_e),e&&s(qs),e&&s(ye),e&&s(zs),e&&s(be),e&&s(Vs),e&&s(z),e&&s(Js),e&&s(Ie),e&&s(Ks),e&&s(Ee),e&&s(Qs),e&&s(Pe),e&&s(Zs),e&&s(ge),e&&s(Xs),e&&s(Me),e&&s(Ys),e&&s(Se),e&&s(et),e&&s(st),e&&s(tt),e&&s(Ce),e&&s(at),e&&s(We),e&&s(lt),e&&s(De)}}}function Zo(V){let h,k;const E=[V[0],Wo];let M={$$slots:{default:[Qo]},$$scope:{ctx:V}};for(let m=0;m<E.length;m+=1)M=il(M,E[m]);return h=new Ko({props:M}),{c(){To(h.$$.fragment)},l(m){Ro(h.$$.fragment,m)},m(m,y){Ao(h,m,y),k=!0},p(m,[y]){const $=y&1?Fo(E,[y&1&&So(m[0]),y&0&&So(Wo)]):{};y&2&&($.$$scope={dirty:y,ctx:m}),h.$set($)},i(m){k||(qo(h.$$.fragment,m),k=!0)},o(m){zo(h.$$.fragment,m),k=!1},d(m){Vo(h,m)}}}const Wo={posted:"2022-07-03T04:28:26.000Z",title:"wmi and hardware serials",subtitle:"how to get hardware serial numbers from wmi using powershell",slug:"wmi-and-hardware-serials",thumbnail:"/img/wmi-and-hardware-serials/thumbnail.png",banner:"/img/wmi-and-hardware-serials/banner.jpg",banner_vid:"/img/wmi-and-hardware-serials/banner.webm"};function Xo(V,h,k){return V.$$set=E=>{k(0,h=il(il({},h),Co(E)))},h=Co(h),[h]}class tn extends xo{constructor(h){super(),jo(this,h,Xo,Zo,Oo,{})}}export{tn as default,Wo as metadata};
